{"version":3,"file":"comboselect.umd.cjs","sources":["../src/utils/Validators.ts","../src/core/Config.ts","../src/core/EventEmitter.ts","../src/core/constants.ts","../src/services/DataService.ts","../src/services/SearchService.ts","../src/utils/DOMHelpers.ts","../src/services/RenderService.ts","../src/utils/Debounce.ts","../src/components/Input.ts","../src/components/Dropdown.ts","../src/components/Tag.ts","../src/components/TagList.ts","../src/core/ComboSelect.ts","../src/web-component/ComboSelectElement.ts"],"sourcesContent":["import type { ComboSelectConfig } from '../types/index';\r\n\r\nexport class Validators {\r\n  static validateConfig(config: Partial<ComboSelectConfig>): void {\r\n    if (config.maxItems !== undefined && config.maxItems < 1) {\r\n      throw new Error('maxItems must be greater than 0');\r\n    }\r\n\r\n    if (config.minChars !== undefined && config.minChars < 0) {\r\n      throw new Error('minChars cannot be negative');\r\n    }\r\n\r\n    if (config.debounceDelay !== undefined && config.debounceDelay < 0) {\r\n      throw new Error('debounceDelay cannot be negative');\r\n    }\r\n\r\n    if (config.incrementValueSize !== undefined && config.incrementValueSize < 1) {\r\n      throw new Error('incrementValueSize must be greater than 0');\r\n    }\r\n\r\n    if (!config.autocompleteUrl && !config.dataSource) {\r\n      console.warn('Neither autocompleteUrl nor dataSource provided. ComboSelect will work in manual mode.');\r\n    }\r\n\r\n    if (config.autocompleteUrl && config.dataSource) {\r\n      console.warn('Both autocompleteUrl and dataSource provided. dataSource will take precedence.');\r\n    }\r\n  }\r\n\r\n  static validateUrl(url: string): boolean {\r\n    try {\r\n      new URL(url);\r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n}","import type { ComboSelectConfig } from '../types/index';\r\nimport { Validators } from '@utils/Validators';\r\n\r\nexport class Config {\r\n  private config: ComboSelectConfig;\r\n\r\n  private static readonly DEFAULT_CONFIG: ComboSelectConfig = {\r\n    placeholder: 'Sélectionner...',\r\n    minChars: 1,\r\n    debounceDelay: 300,\r\n    httpMethod: 'GET',\r\n    searchParam: 'q',\r\n    labelSuggestion: 'label',\r\n    valueSuggestion: null,\r\n    multiple: false,\r\n    closeOnSelect: true,\r\n    clearOnSelect: false,\r\n    allowCreate: false,\r\n    httpHeaders: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n  };\r\n\r\n  constructor(userConfig: Partial<ComboSelectConfig>) {\r\n    Validators.validateConfig(userConfig);\r\n    \r\n    this.config = {\r\n      ...Config.DEFAULT_CONFIG,\r\n      ...userConfig,\r\n    };\r\n  }\r\n\r\n  get<K extends keyof ComboSelectConfig>(key: K): ComboSelectConfig[K] {\r\n    return this.config[key];\r\n  }\r\n\r\n  getAll(): Readonly<ComboSelectConfig> {\r\n    return Object.freeze({ ...this.config });\r\n  }\r\n\r\n  update(updates: Partial<ComboSelectConfig>): void {\r\n    Validators.validateConfig(updates);\r\n    this.config = {\r\n      ...this.config,\r\n      ...updates,\r\n    };\r\n  }\r\n}","import type { ComboSelectEvent } from '../types/index';\r\n\r\nexport class EventEmitter {\r\n  private events: Map<ComboSelectEvent, Set<(...args: any[]) => void>>;\r\n\r\n  constructor() {\r\n    this.events = new Map();\r\n  }\r\n\r\n  on(event: ComboSelectEvent, callback: (...args: any[]) => void): void {\r\n    if (!this.events.has(event)) {\r\n      this.events.set(event, new Set());\r\n    }\r\n    this.events.get(event)!.add(callback);\r\n  }\r\n\r\n  off(event: ComboSelectEvent, callback: (...args: any[]) => void): void {\r\n    const callbacks = this.events.get(event);\r\n    if (callbacks) {\r\n      callbacks.delete(callback);\r\n    }\r\n  }\r\n\r\n  emit(event: ComboSelectEvent, ...args: any[]): void {\r\n    const callbacks = this.events.get(event);\r\n    if (callbacks) {\r\n      callbacks.forEach((callback) => {\r\n        try {\r\n          callback(...args);\r\n        } catch (error) {\r\n          console.error(`Error in event handler for \"${event}\":`, error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  clear(): void {\r\n    this.events.clear();\r\n  }\r\n}","/**\r\n * Constantes globales pour ComboSelect\r\n * @packageDocumentation\r\n */\r\n\r\n/**\r\n * Valeurs par défaut de configuration\r\n * @public\r\n */\r\nexport const DEFAULTS = {\r\n    /** Placeholder par défaut */\r\n    PLACEHOLDER: 'Sélectionner...',\r\n    \r\n    /** Nombre minimum de caractères avant recherche */\r\n    MIN_CHARS: 1,\r\n    \r\n    /** Délai de debounce en millisecondes */\r\n    DEBOUNCE_DELAY: 300,\r\n    \r\n    /** Méthode HTTP par défaut */\r\n    HTTP_METHOD: 'GET' as const,\r\n    \r\n    /** Paramètre de recherche par défaut */\r\n    SEARCH_PARAM: 'q',\r\n    \r\n    /** Clé de label par défaut */\r\n    LABEL_KEY: 'label',\r\n    \r\n    /** Hauteur d'un item dans la liste (pour virtual scrolling) */\r\n    ITEM_HEIGHT: 40,\r\n    \r\n    /** Nombre d'items visibles dans la dropdown */\r\n    VISIBLE_ITEMS: 10,\r\n  } as const;\r\n  \r\n  /**\r\n   * Classes CSS utilisées dans le composant\r\n   * @public\r\n   */\r\n  export const CSS_CLASSES = {\r\n    // Container\r\n    CONTAINER: 'comboselect-container',\r\n    \r\n    // Control\r\n    CONTROL: 'comboselect-control',\r\n    CONTROL_OPEN: 'comboselect-control--open',\r\n    CONTROL_DISABLED: 'comboselect-control--disabled',\r\n    CONTROL_LOADING: 'comboselect-control--loading',\r\n    \r\n    // Input\r\n    INPUT: 'comboselect-input',\r\n    INPUT_WRAPPER: 'comboselect-input-wrapper',\r\n    \r\n    // Dropdown\r\n    DROPDOWN: 'comboselect-dropdown',\r\n    DROPDOWN_OPEN: 'comboselect-dropdown--open',\r\n    \r\n    // Suggestions\r\n    SUGGESTIONS: 'comboselect-suggestions',\r\n    SUGGESTION_ITEM: 'comboselect-suggestion',\r\n    SUGGESTION_ACTIVE: 'comboselect-suggestion--active',\r\n    SUGGESTION_DISABLED: 'comboselect-suggestion--disabled',\r\n    \r\n    // Tags\r\n    TAGS_CONTAINER: 'comboselect-tags',\r\n    TAG: 'comboselect-tag',\r\n    TAG_LABEL: 'comboselect-tag-label',\r\n    TAG_REMOVE: 'comboselect-tag-remove',\r\n    TAG_COUNTER: 'comboselect-tag-counter',\r\n    \r\n    // States\r\n    LOADING: 'comboselect-loading',\r\n    LOADING_SPINNER: 'comboselect-loading-spinner',\r\n    NO_RESULTS: 'comboselect-no-results',\r\n    ERROR: 'comboselect-error',\r\n    \r\n    // Utilities\r\n    DISABLED: 'disabled',\r\n    OPEN: 'open',\r\n    HIDDEN: 'hidden',\r\n  } as const;\r\n  \r\n  /**\r\n   * Événements du composant\r\n   * @public\r\n   */\r\n  export const EVENTS = {\r\n    SELECT: 'select',\r\n    REMOVE: 'remove',\r\n    CHANGE: 'change',\r\n    OPEN: 'open',\r\n    CLOSE: 'close',\r\n    SEARCH: 'search',\r\n    ERROR: 'error',\r\n    LOAD: 'load',\r\n    CREATE: 'create',\r\n    NAVIGATE: 'navigate',\r\n    DISABLED: 'disabled',\r\n    ENABLED: 'enabled',\r\n  } as const;\r\n  \r\n  /**\r\n   * Touches du clavier\r\n   * @public\r\n   */\r\n  export const KEYBOARD_KEYS = {\r\n    ARROW_UP: 'ArrowUp',\r\n    ARROW_DOWN: 'ArrowDown',\r\n    ENTER: 'Enter',\r\n    ESCAPE: 'Escape',\r\n    BACKSPACE: 'Backspace',\r\n    TAB: 'Tab',\r\n    DELETE: 'Delete',\r\n  } as const;\r\n  \r\n  /**\r\n   * Attributs ARIA\r\n   * @public\r\n   */\r\n  export const ARIA_ATTRIBUTES = {\r\n    ROLE_COMBOBOX: 'combobox',\r\n    ROLE_LISTBOX: 'listbox',\r\n    ROLE_OPTION: 'option',\r\n    AUTOCOMPLETE: 'list',\r\n    EXPANDED: 'aria-expanded',\r\n    HASPOPUP: 'aria-haspopup',\r\n    ACTIVEDESCENDANT: 'aria-activedescendant',\r\n    SELECTED: 'aria-selected',\r\n    DISABLED: 'aria-disabled',\r\n    LABEL: 'aria-label',\r\n    LABELLEDBY: 'aria-labelledby',\r\n  } as const;\r\n  \r\n  /**\r\n   * Messages d'erreur\r\n   * @public\r\n   */\r\n  export const ERROR_MESSAGES = {\r\n    INVALID_SELECTOR: 'Invalid selector: element not found',\r\n    NOT_INPUT_ELEMENT: 'Element must be an input element',\r\n    MAX_ITEMS_INVALID: 'maxItems must be greater than 0',\r\n    MIN_CHARS_INVALID: 'minChars cannot be negative',\r\n    DEBOUNCE_INVALID: 'debounceDelay cannot be negative',\r\n    INCREMENT_SIZE_INVALID: 'incrementValueSize must be greater than 0',\r\n    NO_DATA_SOURCE: 'Neither autocompleteUrl nor dataSource provided',\r\n    FETCH_ERROR: 'Error fetching data',\r\n    PARSE_ERROR: 'Error parsing response',\r\n  } as const;\r\n  \r\n  /**\r\n   * Headers HTTP par défaut\r\n   * @public\r\n   */\r\n  export const DEFAULT_HTTP_HEADERS = {\r\n    'Content-Type': 'application/json',\r\n    'Accept': 'application/json',\r\n  } as const;\r\n  \r\n  /**\r\n   * Regex patterns\r\n   * @internal\r\n   */\r\n  export const PATTERNS = {\r\n    /** Pattern pour nettoyer le HTML */\r\n    HTML_TAGS: /<[^>]*>/g,\r\n    \r\n    /** Pattern pour les espaces multiples */\r\n    MULTIPLE_SPACES: /\\s+/g,\r\n    \r\n    /** Pattern pour valider une URL */\r\n    URL: /^https?:\\/\\/.+/i,\r\n  } as const;\r\n  \r\n  /**\r\n   * Timeouts et délais\r\n   * @public\r\n   */\r\n  export const TIMEOUTS = {\r\n    /** Délai avant fermeture automatique du dropdown (ms) */\r\n    AUTO_CLOSE: 5000,\r\n    \r\n    /** Délai d'animation CSS (ms) */\r\n    ANIMATION: 200,\r\n    \r\n    /** Délai avant retry en cas d'erreur (ms) */\r\n    RETRY_DELAY: 1000,\r\n    \r\n    /** Timeout pour les requêtes HTTP (ms) */\r\n    HTTP_TIMEOUT: 10000,\r\n  } as const;\r\n  \r\n  /**\r\n   * Limites du composant\r\n   * @public\r\n   */\r\n  export const LIMITS = {\r\n    /** Nombre maximum d'items dans la dropdown */\r\n    MAX_SUGGESTIONS: 100,\r\n    \r\n    /** Longueur maximale du label d'un tag */\r\n    MAX_TAG_LABEL_LENGTH: 50,\r\n    \r\n    /** Nombre maximum d'items sélectionnables par défaut */\r\n    DEFAULT_MAX_ITEMS: 999,\r\n    \r\n    /** Taille maximale du cache (nombre d'entrées) */\r\n    MAX_CACHE_SIZE: 50,\r\n  } as const;\r\n  \r\n  /**\r\n   * Type helper pour extraire les valeurs des constantes\r\n   */\r\n  export type ValueOf<T> = T[keyof T];\r\n  \r\n  /**\r\n   * Type pour les classes CSS\r\n   */\r\n  export type CSSClass = ValueOf<typeof CSS_CLASSES>;\r\n  \r\n  /**\r\n   * Type pour les événements\r\n   */\r\n  export type EventType = ValueOf<typeof EVENTS>;\r\n  \r\n  /**\r\n   * Type pour les touches du clavier\r\n   */\r\n  export type KeyboardKey = ValueOf<typeof KEYBOARD_KEYS>;","/**\r\n * Service de gestion des données\r\n * Gère le chargement et la transformation des données depuis différentes sources\r\n */\r\n\r\nimport type { ComboSelectConfig } from '../types';\r\nimport { DEFAULTS, DEFAULT_HTTP_HEADERS, ERROR_MESSAGES, TIMEOUTS } from '../core/constants';\r\n\r\n/**\r\n * Service pour gérer les sources de données\r\n * @public\r\n */\r\nexport class DataService<T = any> {\r\n  private config: ComboSelectConfig<T>;\r\n  private cache: Map<string, T[]> = new Map();\r\n  private abortController: AbortController | null = null;\r\n\r\n  constructor(config: ComboSelectConfig<T>) {\r\n    this.config = config;\r\n  }\r\n\r\n  /**\r\n   * Charger les données selon la configuration\r\n   * @param query - Requête de recherche (pour API)\r\n   * @returns Promesse avec les données\r\n   */\r\n  async loadData(query?: string): Promise<T[]> {\r\n    // Source locale\r\n    if (this.config.dataSource) {\r\n      return this.loadLocalData();\r\n    }\r\n\r\n    // Source API\r\n    if (this.config.autocompleteUrl) {\r\n      return this.loadRemoteData(query || '');\r\n    }\r\n\r\n    throw new Error(ERROR_MESSAGES.NO_DATA_SOURCE);\r\n  }\r\n\r\n  /**\r\n   * Charger les données locales\r\n   * @private\r\n   */\r\n  private async loadLocalData(): Promise<T[]> {\r\n    const { dataSource } = this.config;\r\n\r\n    if (!dataSource) {\r\n      return [];\r\n    }\r\n\r\n    // Si c'est une fonction\r\n    if (typeof dataSource === 'function') {\r\n      const result = dataSource();\r\n      // Si la fonction retourne une promesse\r\n      if (result instanceof Promise) {\r\n        return await result;\r\n      }\r\n      return result;\r\n    }\r\n\r\n    // Si c'est un tableau\r\n    return dataSource;\r\n  }\r\n\r\n  /**\r\n   * Charger les données depuis une API\r\n   * @param query - Requête de recherche\r\n   * @private\r\n   */\r\n  private async loadRemoteData(query: string): Promise<T[]> {\r\n    const { autocompleteUrl, searchParam, httpMethod, httpHeaders } = this.config;\r\n\r\n    if (!autocompleteUrl) {\r\n      throw new Error(ERROR_MESSAGES.NO_DATA_SOURCE);\r\n    }\r\n\r\n    // Vérifier le cache\r\n    const cacheKey = `${autocompleteUrl}:${query}`;\r\n    if (this.cache.has(cacheKey)) {\r\n      return this.cache.get(cacheKey)!;\r\n    }\r\n\r\n    // Annuler la requête précédente si elle existe\r\n    if (this.abortController) {\r\n      this.abortController.abort();\r\n    }\r\n\r\n    this.abortController = new AbortController();\r\n\r\n    try {\r\n      let url = autocompleteUrl;\r\n      let fetchOptions: RequestInit = {\r\n        signal: this.abortController.signal,\r\n        headers: {\r\n          ...DEFAULT_HTTP_HEADERS,\r\n          ...httpHeaders,\r\n        },\r\n      };\r\n\r\n      const method = httpMethod || DEFAULTS.HTTP_METHOD;\r\n      const param = searchParam || DEFAULTS.SEARCH_PARAM;\r\n\r\n      if (method === 'GET') {\r\n        // Ajouter le paramètre de recherche à l'URL\r\n        const separator = url.includes('?') ? '&' : '?';\r\n        url = `${url}${separator}${param}=${encodeURIComponent(query)}`;\r\n        fetchOptions.method = 'GET';\r\n      } else {\r\n        // POST - Envoyer dans le body\r\n        fetchOptions.method = 'POST';\r\n        fetchOptions.body = JSON.stringify({ [param]: query });\r\n      }\r\n\r\n      // Timeout\r\n      const timeoutId = setTimeout(() => {\r\n        this.abortController?.abort();\r\n      }, TIMEOUTS.HTTP_TIMEOUT);\r\n\r\n      const response = await fetch(url, fetchOptions);\r\n      clearTimeout(timeoutId);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`${ERROR_MESSAGES.FETCH_ERROR}: ${response.status} ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      const results = this.extractResults(data);\r\n\r\n      // Mettre en cache\r\n      this.cache.set(cacheKey, results);\r\n\r\n      return results;\r\n    } catch (error) {\r\n      if (error instanceof Error) {\r\n        if (error.name === 'AbortError') {\r\n          // Requête annulée, ne pas logger\r\n          return [];\r\n        }\r\n        throw new Error(`${ERROR_MESSAGES.FETCH_ERROR}: ${error.message}`);\r\n      }\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Extraire les résultats de la réponse API\r\n   * @param data - Données brutes de l'API\r\n   * @private\r\n   */\r\n  private extractResults(data: any): T[] {\r\n    const { resultsKey, transformResponse } = this.config;\r\n\r\n    // Si une fonction de transformation est fournie\r\n    if (transformResponse) {\r\n      try {\r\n        return transformResponse(data);\r\n      } catch (error) {\r\n        throw new Error(ERROR_MESSAGES.PARSE_ERROR);\r\n      }\r\n    }\r\n\r\n    // Si une clé de résultats est spécifiée\r\n    if (resultsKey) {\r\n      try {\r\n        // Support pour les clés imbriquées: \"data.items\" ou [\"data\", \"items\"]\r\n        const keys = Array.isArray(resultsKey) ? resultsKey : resultsKey.split('.');\r\n        let result = data;\r\n\r\n        for (const key of keys) {\r\n          if (result && typeof result === 'object' && key in result) {\r\n            result = result[key];\r\n          } else {\r\n            throw new Error(`Key \"${key}\" not found in response`);\r\n          }\r\n        }\r\n\r\n        if (Array.isArray(result)) {\r\n          return result as T[];\r\n        }\r\n\r\n        throw new Error('Results is not an array');\r\n      } catch (error) {\r\n        console.error('Error extracting results:', error);\r\n        throw new Error(ERROR_MESSAGES.PARSE_ERROR);\r\n      }\r\n    }\r\n\r\n    // Par défaut, retourner les données si c'est un tableau\r\n    if (Array.isArray(data)) {\r\n      return data as T[];\r\n    }\r\n\r\n    throw new Error(ERROR_MESSAGES.PARSE_ERROR);\r\n  }\r\n\r\n  /**\r\n   * Filtrer les données localement\r\n   * @param data - Données à filtrer\r\n   * @param query - Requête de recherche\r\n   * @returns Données filtrées\r\n   */\r\n  filterData(data: T[], query: string): T[] {\r\n    if (!query || query.trim() === '') {\r\n      return data;\r\n    }\r\n\r\n    const searchTerm = query.toLowerCase().trim();\r\n    const { labelSuggestion } = this.config;\r\n    const labelKey = (labelSuggestion as string) || DEFAULTS.LABEL_KEY;\r\n\r\n    return data.filter((item) => {\r\n      // Récupérer le label de l'item\r\n      const label = this.getItemLabel(item, labelKey);\r\n      return label.toLowerCase().includes(searchTerm);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Obtenir le label d'un item\r\n   * @param item - Item\r\n   * @param labelKey - Clé du label\r\n   * @private\r\n   */\r\n  private getItemLabel(item: T, labelKey: string): string {\r\n    if (typeof item === 'string') {\r\n      return item;\r\n    }\r\n\r\n    if (typeof item === 'object' && item !== null) {\r\n      const value = (item as any)[labelKey];\r\n      return value !== undefined && value !== null ? String(value) : '';\r\n    }\r\n\r\n    return String(item);\r\n  }\r\n\r\n  /**\r\n   * Vider le cache\r\n   */\r\n  clearCache(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Annuler les requêtes en cours\r\n   */\r\n  abort(): void {\r\n    if (this.abortController) {\r\n      this.abortController.abort();\r\n      this.abortController = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Obtenir la taille du cache\r\n   */\r\n  getCacheSize(): number {\r\n    return this.cache.size;\r\n  }\r\n\r\n  /**\r\n   * Supprimer une entrée du cache\r\n   * @param query - Requête à supprimer du cache\r\n   */\r\n  removeCacheEntry(query: string): void {\r\n    const { autocompleteUrl } = this.config;\r\n    if (autocompleteUrl) {\r\n      const cacheKey = `${autocompleteUrl}:${query}`;\r\n      this.cache.delete(cacheKey);\r\n    }\r\n  }\r\n}","/**\r\n * Service de recherche\r\n * Gère la recherche, le debounce et les événements associés\r\n */\r\n\r\nimport type { ComboSelectConfig, SuggestionItem } from '../types';\r\nimport { DataService } from './DataService';\r\nimport { DEFAULTS } from '../core/constants';\r\n\r\n/**\r\n * Type pour le callback de résultats\r\n */\r\ntype SearchResultCallback<T> = (results: SuggestionItem<T>[]) => void;\r\n\r\n/**\r\n * Type pour le callback d'erreur\r\n */\r\ntype SearchErrorCallback = (error: Error) => void;\r\n\r\n/**\r\n * Service pour gérer la recherche\r\n * @public\r\n */\r\nexport class SearchService<T = any> {\r\n  private config: ComboSelectConfig<T>;\r\n  private dataService: DataService<T>;\r\n  private debounceTimer: number | null = null;\r\n  private lastQuery: string = '';\r\n  private isSearching: boolean = false;\r\n\r\n  // Callbacks\r\n  private onResults: SearchResultCallback<T> | null = null;\r\n  private onError: SearchErrorCallback | null = null;\r\n  private onSearchStart: (() => void) | null = null;\r\n  private onSearchEnd: (() => void) | null = null;\r\n\r\n  constructor(config: ComboSelectConfig<T>, dataService: DataService<T>) {\r\n    this.config = config;\r\n    this.dataService = dataService;\r\n  }\r\n\r\n  /**\r\n   * Effectuer une recherche\r\n   * @param query - Requête de recherche\r\n   */\r\n  search(query: string): void {\r\n    // Vérifier le nombre minimum de caractères\r\n    const minChars = this.config.minChars ?? DEFAULTS.MIN_CHARS;\r\n    \r\n    if (query.length < minChars) {\r\n      this.clearResults();\r\n      return;\r\n    }\r\n\r\n    // Si la requête n'a pas changé, ne rien faire\r\n    if (query === this.lastQuery) {\r\n      return;\r\n    }\r\n\r\n    this.lastQuery = query;\r\n\r\n    // Annuler le timer précédent\r\n    this.cancelDebounce();\r\n\r\n    // Appliquer le debounce\r\n    const debounceDelay = this.config.debounceDelay ?? DEFAULTS.DEBOUNCE_DELAY;\r\n    \r\n    this.debounceTimer = window.setTimeout(() => {\r\n      this.performSearch(query);\r\n    }, debounceDelay);\r\n  }\r\n\r\n  /**\r\n   * Effectuer la recherche immédiatement (sans debounce)\r\n   * @param query - Requête de recherche\r\n   */\r\n  searchImmediate(query: string): void {\r\n    this.cancelDebounce();\r\n    this.lastQuery = query;\r\n    this.performSearch(query);\r\n  }\r\n\r\n  /**\r\n   * Effectuer la recherche réelle\r\n   * @param query - Requête de recherche\r\n   * @private\r\n   */\r\n  private async performSearch(query: string): Promise<void> {\r\n    if (this.isSearching) {\r\n      return;\r\n    }\r\n\r\n    this.isSearching = true;\r\n    this.onSearchStart?.();\r\n\r\n    // Callback onSearch si défini\r\n    if (this.config.onSearch) {\r\n      try {\r\n        await this.config.onSearch(query);\r\n      } catch (error) {\r\n        console.error('Error in onSearch callback:', error);\r\n      }\r\n    }\r\n\r\n    try {\r\n      // Charger les données\r\n      const data = await this.dataService.loadData(query);\r\n\r\n      // Filtrer si source locale\r\n      let filteredData = data;\r\n      if (this.config.dataSource) {\r\n        filteredData = this.dataService.filterData(data, query);\r\n      }\r\n\r\n      // Transformer en SuggestionItems\r\n      const suggestions = this.transformToSuggestions(filteredData);\r\n\r\n      // Envoyer les résultats\r\n      this.onResults?.(suggestions);\r\n\r\n      // Callback onLoad si défini\r\n      if (this.config.onLoad) {\r\n        try {\r\n          await this.config.onLoad(filteredData);\r\n        } catch (error) {\r\n          console.error('Error in onLoad callback:', error);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      const errorObj = error instanceof Error ? error : new Error('Search failed');\r\n      this.onError?.(errorObj);\r\n\r\n      // Callback onError si défini\r\n      if (this.config.onError) {\r\n        try {\r\n          await this.config.onError(errorObj);\r\n        } catch (callbackError) {\r\n          console.error('Error in onError callback:', callbackError);\r\n        }\r\n      }\r\n    } finally {\r\n      this.isSearching = false;\r\n      this.onSearchEnd?.();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Transformer les données en SuggestionItems\r\n   * @param data - Données brutes\r\n   * @private\r\n   */\r\n  private transformToSuggestions(data: T[]): SuggestionItem<T>[] {\r\n    const { labelSuggestion, valueSuggestion } = this.config;\r\n    const labelKey = (labelSuggestion as string) || DEFAULTS.LABEL_KEY;\r\n    const valueKey = valueSuggestion as string | null;\r\n\r\n    return data.map((item) => {\r\n      let label: string;\r\n      let value: any;\r\n\r\n      // Extraire le label\r\n      if (typeof item === 'string') {\r\n        label = item;\r\n        value = item;\r\n      } else if (typeof item === 'object' && item !== null) {\r\n        label = String((item as any)[labelKey] ?? '');\r\n        value = valueKey ? (item as any)[valueKey] : (item as any)[labelKey];\r\n      } else {\r\n        label = String(item);\r\n        value = item;\r\n      }\r\n\r\n      return {\r\n        label,\r\n        value,\r\n        original: item,\r\n        disabled: false,\r\n        highlighted: false,\r\n      };\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Vider les résultats\r\n   */\r\n  clearResults(): void {\r\n    this.lastQuery = '';\r\n    this.onResults?.([]);\r\n  }\r\n\r\n  /**\r\n   * Annuler le debounce en cours\r\n   */\r\n  cancelDebounce(): void {\r\n    if (this.debounceTimer !== null) {\r\n      clearTimeout(this.debounceTimer);\r\n      this.debounceTimer = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Annuler toutes les requêtes en cours\r\n   */\r\n  abort(): void {\r\n    this.cancelDebounce();\r\n    this.dataService.abort();\r\n    this.isSearching = false;\r\n  }\r\n\r\n  /**\r\n   * Définir le callback pour les résultats\r\n   * @param callback - Fonction appelée avec les résultats\r\n   */\r\n  setOnResults(callback: SearchResultCallback<T>): void {\r\n    this.onResults = callback;\r\n  }\r\n\r\n  /**\r\n   * Définir le callback pour les erreurs\r\n   * @param callback - Fonction appelée en cas d'erreur\r\n   */\r\n  setOnError(callback: SearchErrorCallback): void {\r\n    this.onError = callback;\r\n  }\r\n\r\n  /**\r\n   * Définir le callback pour le début de recherche\r\n   * @param callback - Fonction appelée au début de la recherche\r\n   */\r\n  setOnSearchStart(callback: () => void): void {\r\n    this.onSearchStart = callback;\r\n  }\r\n\r\n  /**\r\n   * Définir le callback pour la fin de recherche\r\n   * @param callback - Fonction appelée à la fin de la recherche\r\n   */\r\n  setOnSearchEnd(callback: () => void): void {\r\n    this.onSearchEnd = callback;\r\n  }\r\n\r\n  /**\r\n   * Vérifier si une recherche est en cours\r\n   */\r\n  get searching(): boolean {\r\n    return this.isSearching;\r\n  }\r\n\r\n  /**\r\n   * Obtenir la dernière requête\r\n   */\r\n  getLastQuery(): string {\r\n    return this.lastQuery;\r\n  }\r\n\r\n  /**\r\n   * Réinitialiser le service\r\n   */\r\n  reset(): void {\r\n    this.abort();\r\n    this.clearResults();\r\n    this.lastQuery = '';\r\n  }\r\n}","export class DOMHelpers {\r\n    static createElement<K extends keyof HTMLElementTagNameMap>(\r\n      tag: K,\r\n      className?: string,\r\n      attributes?: Record<string, string>\r\n    ): HTMLElementTagNameMap[K] {\r\n      const element = document.createElement(tag);\r\n      \r\n      if (className) {\r\n        element.className = className;\r\n      }\r\n      \r\n      if (attributes) {\r\n        Object.entries(attributes).forEach(([key, value]) => {\r\n          element.setAttribute(key, value);\r\n        });\r\n      }\r\n      \r\n      return element;\r\n    }\r\n  \r\n    static removeAllChildren(element: HTMLElement): void {\r\n      while (element.firstChild) {\r\n        element.removeChild(element.firstChild);\r\n      }\r\n    }\r\n  \r\n    static escapeHtml(text: string): string {\r\n      const div = document.createElement('div');\r\n      div.textContent = text;\r\n      return div.innerHTML;\r\n    }\r\n  \r\n    static getOffset(element: HTMLElement): { top: number; left: number } {\r\n      const rect = element.getBoundingClientRect();\r\n      return {\r\n        top: rect.top + window.scrollY,\r\n        left: rect.left + window.scrollX,\r\n      };\r\n    }\r\n  \r\n    static isDescendant(parent: HTMLElement, child: HTMLElement): boolean {\r\n      let node: HTMLElement | null = child;\r\n      while (node) {\r\n        if (node === parent) {\r\n          return true;\r\n        }\r\n        node = node.parentElement;\r\n      }\r\n      return false;\r\n    }\r\n  }","import type { SuggestionItem, SelectedItem } from '../types/index';\r\nimport { Config } from '@core/Config';\r\nimport { DOMHelpers } from '@utils/DOMHelpers';\r\n\r\nexport class RenderService {\r\n  private config: Config;\r\n\r\n  constructor(config: Config) {\r\n    this.config = config;\r\n  }\r\n\r\n  renderSuggestion(item: SuggestionItem): string {\r\n    const customRender = this.config.get('renderSuggestion');\r\n    \r\n    if (customRender) {\r\n      return customRender(item.original);\r\n    }\r\n\r\n    return DOMHelpers.escapeHtml(item.label);\r\n  }\r\n\r\n  renderTag(item: SelectedItem): string {\r\n    const customRender = this.config.get('renderTag');\r\n    \r\n    if (customRender) {\r\n      return customRender(item);\r\n    }\r\n\r\n    return DOMHelpers.escapeHtml(item.label);\r\n  }\r\n\r\n  renderNoResults(): string {\r\n    return '<div class=\"comboselect-no-results\">Aucun résultat trouvé</div>';\r\n  }\r\n\r\n  renderLoading(): string {\r\n    return `\r\n      <div class=\"comboselect-loading\">\r\n        <span class=\"comboselect-loading-spinner\"></span>\r\n        <span>Chargement...</span>\r\n      </div>\r\n    `;\r\n  }\r\n}","export function debounce<T extends (...args: any[]) => any>(\r\n    func: T,\r\n    wait: number\r\n  ): (...args: Parameters<T>) => void {\r\n    let timeout: ReturnType<typeof setTimeout> | null = null;\r\n  \r\n    return function executedFunction(...args: Parameters<T>) {\r\n      const later = () => {\r\n        timeout = null;\r\n        func(...args);\r\n      };\r\n  \r\n      if (timeout) {\r\n        clearTimeout(timeout);\r\n      }\r\n      timeout = setTimeout(later, wait);\r\n    };\r\n  }","import { Config } from '@core/Config';\r\nimport { EventEmitter } from '@core/EventEmitter';\r\nimport { DOMHelpers } from '@utils/DOMHelpers';\r\nimport { debounce } from '@utils/Debounce';\r\n\r\nexport class Input {\r\n  private element: HTMLInputElement;\r\n  private config: Config;\r\n  private events: EventEmitter;\r\n  private debouncedSearch: (query: string) => void;\r\n\r\n  constructor(config: Config, events: EventEmitter) {\r\n    this.config = config;\r\n    this.events = events;\r\n    this.element = this.create();\r\n    this.debouncedSearch = debounce(\r\n      (query: string) => this.handleSearch(query),\r\n      config.get('debounceDelay') || 300\r\n    );\r\n    this.attachEvents();\r\n  }\r\n\r\n  private create(): HTMLInputElement {\r\n    const input = DOMHelpers.createElement('input', 'comboselect-input', {\r\n      type: 'text',\r\n      placeholder: this.config.get('placeholder') || '',\r\n      autocomplete: 'off',\r\n      role: 'combobox',\r\n      'aria-autocomplete': 'list',\r\n      'aria-expanded': 'false',\r\n      'aria-haspopup': 'listbox',\r\n    });\r\n\r\n    return input;\r\n  }\r\n\r\n  private attachEvents(): void {\r\n    this.element.addEventListener('input', (e) => {\r\n      const target = e.target as HTMLInputElement;\r\n      const query = target.value.trim();\r\n      const minChars = this.config.get('minChars') || 1;\r\n\r\n      if (query.length >= minChars) {\r\n        this.debouncedSearch(query);\r\n      } else if (query.length === 0) {\r\n        this.events.emit('close');\r\n      }\r\n    });\r\n\r\n    this.element.addEventListener('focus', () => {\r\n      const query = this.element.value.trim();\r\n      const minChars = this.config.get('minChars') || 1;\r\n      \r\n      if (query.length >= minChars) {\r\n        this.handleSearch(query);\r\n      }\r\n    });\r\n\r\n    this.element.addEventListener('keydown', (e) => {\r\n      this.handleKeydown(e);\r\n    });\r\n  }\r\n\r\n  private handleSearch(query: string): void {\r\n    this.events.emit('search', query);\r\n  }\r\n\r\n  private handleKeydown(e: KeyboardEvent): void {\r\n    switch (e.key) {\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        this.events.emit('navigate', 'down');\r\n        break;\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        this.events.emit('navigate', 'up');\r\n        break;\r\n      case 'Enter':\r\n        e.preventDefault();\r\n        this.events.emit('navigate', 'select');\r\n        break;\r\n      case 'Escape':\r\n        e.preventDefault();\r\n        this.events.emit('close');\r\n        break;\r\n    }\r\n  }\r\n\r\n  getElement(): HTMLInputElement {\r\n    return this.element;\r\n  }\r\n\r\n  getValue(): string {\r\n    return this.element.value;\r\n  }\r\n\r\n  setValue(value: string): void {\r\n    this.element.value = value;\r\n  }\r\n\r\n  clear(): void {\r\n    this.element.value = '';\r\n  }\r\n\r\n  focus(): void {\r\n    this.element.focus();\r\n  }\r\n\r\n  disable(): void {\r\n    this.element.disabled = true;\r\n  }\r\n\r\n  enable(): void {\r\n    this.element.disabled = false;\r\n  }\r\n\r\n  setAriaExpanded(expanded: boolean): void {\r\n    this.element.setAttribute('aria-expanded', String(expanded));\r\n  }\r\n\r\n  destroy(): void {\r\n    this.element.remove();\r\n  }\r\n}","import type { SuggestionItem } from '../types/index';\r\n\r\nimport { EventEmitter } from '@core/EventEmitter';\r\nimport { RenderService } from '@services/RenderService';\r\nimport { DOMHelpers } from '@utils/DOMHelpers';\r\n\r\nexport class Dropdown {\r\n  private element: HTMLElement;\r\n  private events: EventEmitter;\r\n  private renderService: RenderService;\r\n  private suggestions: SuggestionItem[];\r\n  private focusedIndex: number;\r\n  private isOpen: boolean;\r\n\r\n  constructor(\r\n    events: EventEmitter, \r\n    renderService: RenderService\r\n  ) {\r\n    this.events = events;\r\n    this.renderService = renderService;\r\n    this.suggestions = [];\r\n    this.focusedIndex = -1;\r\n    this.isOpen = false;\r\n    this.element = this.create();\r\n    this.attachEvents();\r\n  }\r\n\r\n  private create(): HTMLElement {\r\n    const dropdown = DOMHelpers.createElement('div', 'comboselect-dropdown hidden', {\r\n      role: 'listbox',\r\n    });\r\n\r\n    return dropdown;\r\n  }\r\n\r\n  private attachEvents(): void {\r\n    this.events.on('navigate', (direction: 'up' | 'down' | 'select') => {\r\n      this.handleNavigation(direction);\r\n    });\r\n  }\r\n\r\n  open(): void {\r\n    if (!this.isOpen) {\r\n      this.element.classList.remove('hidden');\r\n      this.isOpen = true;\r\n      this.events.emit('open');\r\n    }\r\n  }\r\n\r\n  close(): void {\r\n    if (this.isOpen) {\r\n      this.element.classList.add('hidden');\r\n      this.isOpen = false;\r\n      this.focusedIndex = -1;\r\n      this.events.emit('close');\r\n    }\r\n  }\r\n\r\n  render(suggestions: SuggestionItem[]): void {\r\n    this.suggestions = suggestions;\r\n    this.focusedIndex = -1;\r\n    DOMHelpers.removeAllChildren(this.element);\r\n\r\n    if (suggestions.length === 0) {\r\n      this.element.innerHTML = this.renderService.renderNoResults();\r\n      this.open();\r\n      return;\r\n    }\r\n\r\n    suggestions.forEach((suggestion, index) => {\r\n      const option = this.createOption(suggestion, index);\r\n      this.element.appendChild(option);\r\n    });\r\n\r\n    this.open();\r\n  }\r\n\r\n  renderLoading(): void {\r\n    DOMHelpers.removeAllChildren(this.element);\r\n    this.element.innerHTML = this.renderService.renderLoading();\r\n    this.open();\r\n  }\r\n\r\n  private createOption(suggestion: SuggestionItem, index: number): HTMLElement {\r\n    const option = DOMHelpers.createElement('div', 'comboselect-option', {\r\n      role: 'option',\r\n      'data-index': String(index),\r\n    });\r\n\r\n    option.innerHTML = this.renderService.renderSuggestion(suggestion);\r\n\r\n    if (suggestion.disabled) {\r\n      option.classList.add('disabled');\r\n      option.setAttribute('aria-disabled', 'true');\r\n    }\r\n\r\n    option.addEventListener('mousedown', (e) => {\r\n      e.preventDefault();\r\n      if (!suggestion.disabled) {\r\n        this.selectOption(index);\r\n      }\r\n    });\r\n\r\n    option.addEventListener('mouseenter', () => {\r\n      if (!suggestion.disabled) {\r\n        this.focusOption(index);\r\n      }\r\n    });\r\n\r\n    return option;\r\n  }\r\n\r\n  private handleNavigation(direction: 'up' | 'down' | 'select'): void {\r\n    if (!this.isOpen || this.suggestions.length === 0) {\r\n      return;\r\n    }\r\n\r\n    if (direction === 'select') {\r\n      if (this.focusedIndex >= 0) {\r\n        this.selectOption(this.focusedIndex);\r\n      }\r\n      return;\r\n    }\r\n\r\n    const maxIndex = this.suggestions.length - 1;\r\n    let newIndex = this.focusedIndex;\r\n\r\n    if (direction === 'down') {\r\n      newIndex = this.focusedIndex < maxIndex ? this.focusedIndex + 1 : 0;\r\n    } else if (direction === 'up') {\r\n      newIndex = this.focusedIndex > 0 ? this.focusedIndex - 1 : maxIndex;\r\n    }\r\n\r\n    while (this.suggestions[newIndex]?.disabled) {\r\n      if (direction === 'down') {\r\n        newIndex = newIndex < maxIndex ? newIndex + 1 : 0;\r\n      } else {\r\n        newIndex = newIndex > 0 ? newIndex - 1 : maxIndex;\r\n      }\r\n\r\n      if (newIndex === this.focusedIndex) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.focusOption(newIndex);\r\n  }\r\n\r\n  private focusOption(index: number): void {\r\n    if (this.focusedIndex >= 0) {\r\n      const prevOption = this.element.querySelector(`[data-index=\"${this.focusedIndex}\"]`);\r\n      prevOption?.classList.remove('focused');\r\n    }\r\n\r\n    this.focusedIndex = index;\r\n\r\n    const option = this.element.querySelector(`[data-index=\"${index}\"]`);\r\n    if (option) {\r\n      option.classList.add('focused');\r\n      option.scrollIntoView({ block: 'nearest' });\r\n    }\r\n  }\r\n\r\n  private selectOption(index: number): void {\r\n    const suggestion = this.suggestions[index];\r\n    if (suggestion && !suggestion.disabled) {\r\n      this.events.emit('select', {\r\n        label: suggestion.label,\r\n        value: suggestion.value,\r\n        original: suggestion.original,\r\n      });\r\n    }\r\n  }\r\n\r\n  getElement(): HTMLElement {\r\n    return this.element;\r\n  }\r\n\r\n  isDropdownOpen(): boolean {\r\n    return this.isOpen;\r\n  }\r\n\r\n  destroy(): void {\r\n    this.close();\r\n    this.element.remove();\r\n  }\r\n}","import type { SelectedItem } from '../types/index';\r\nimport { DOMHelpers } from '@utils/DOMHelpers';\r\nimport { EventEmitter } from '@core/EventEmitter';\r\n\r\nexport class Tag {\r\n  private element: HTMLElement;\r\n  private item: SelectedItem;\r\n  private events: EventEmitter;\r\n\r\n  constructor(item: SelectedItem, renderContent: string, events: EventEmitter) {\r\n    this.item = item;\r\n    this.events = events;\r\n    this.element = this.create(renderContent);\r\n  }\r\n\r\n  private create(renderContent: string): HTMLElement {\r\n    const tag = DOMHelpers.createElement('span', 'comboselect-tag');\r\n    tag.setAttribute('data-value', JSON.stringify(this.item.value));\r\n    \r\n    const content = DOMHelpers.createElement('span');\r\n    content.innerHTML = renderContent;\r\n    tag.appendChild(content);\r\n\r\n    const removeBtn = DOMHelpers.createElement('button', 'comboselect-tag-remove', {\r\n      type: 'button',\r\n      'aria-label': `Retirer ${this.item.label}`,\r\n    });\r\n    removeBtn.innerHTML = '&times;';\r\n    removeBtn.addEventListener('click', (e) => {\r\n      e.stopPropagation();\r\n      this.remove();\r\n    });\r\n\r\n    tag.appendChild(removeBtn);\r\n\r\n    return tag;\r\n  }\r\n\r\n  private remove(): void {\r\n    this.events.emit('remove', this.item);\r\n    this.element.remove();\r\n  }\r\n\r\n  getElement(): HTMLElement {\r\n    return this.element;\r\n  }\r\n\r\n  getItem(): SelectedItem {\r\n    return this.item;\r\n  }\r\n\r\n  destroy(): void {\r\n    this.element.remove();\r\n  }\r\n}","import type { SelectedItem } from '../types/index';\r\nimport { Config } from '@core/Config';\r\nimport { EventEmitter } from '@core/EventEmitter';\r\nimport { RenderService } from '@services/RenderService';\r\nimport { Tag } from './Tag';\r\nimport { DOMHelpers } from '@utils/DOMHelpers';\r\n\r\nexport class TagList {\r\n  private container: HTMLElement;\r\n  private config: Config;\r\n  private events: EventEmitter;\r\n  private renderService: RenderService;\r\n  private tags: Tag[];\r\n  private counterElement?: HTMLElement;\r\n\r\n  constructor(\r\n    container: HTMLElement,\r\n    config: Config,\r\n    events: EventEmitter,\r\n    renderService: RenderService\r\n  ) {\r\n    this.container = container;\r\n    this.config = config;\r\n    this.events = events;\r\n    this.renderService = renderService;\r\n    this.tags = [];\r\n  }\r\n\r\n  add(item: SelectedItem): boolean {\r\n    const existingTagIndex = this.tags.findIndex((tag) => {\r\n      const existingValue = JSON.stringify(tag.getItem().value);\r\n      const newValue = JSON.stringify(item.value);\r\n      return existingValue === newValue;\r\n    });\r\n\r\n    if (existingTagIndex !== -1) {\r\n      console.warn('Item already selected:', item);\r\n      this.highlightTag(existingTagIndex);\r\n      return false;\r\n    }\r\n\r\n    const renderContent = this.renderService.renderTag(item);\r\n    const tag = new Tag(item, renderContent, this.events);\r\n    this.tags.push(tag);\r\n    this.render();\r\n    return true;\r\n  }\r\n\r\n  public hasItem(item: SelectedItem): boolean {\r\n    return this.tags.some((tag) => {\r\n      const existingValue = JSON.stringify(tag.getItem().value);\r\n      const newValue = JSON.stringify(item.value);\r\n      return existingValue === newValue;\r\n    });\r\n  }\r\n\r\n  private highlightTag(index: number): void {\r\n    const tag = this.tags[index];\r\n    if (!tag) return;\r\n\r\n    const element = tag.getElement();\r\n    element.classList.add('comboselect-tag-highlight');\r\n    \r\n    setTimeout(() => {\r\n      element.classList.remove('comboselect-tag-highlight');\r\n    }, 600);\r\n  }\r\n\r\n  remove(item: SelectedItem): void {\r\n    const index = this.tags.findIndex(\r\n      (tag) => JSON.stringify(tag.getItem().value) === JSON.stringify(item.value)\r\n    );\r\n\r\n    if (index !== -1) {\r\n      this.tags[index]?.destroy();\r\n      this.tags.splice(index, 1);\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  clear(): void {\r\n    this.tags.forEach((tag) => tag.destroy());\r\n    this.tags = [];\r\n    this.render();\r\n  }\r\n\r\n  getItems(): SelectedItem[] {\r\n    return this.tags.map((tag) => tag.getItem());\r\n  }\r\n\r\n  private render(): void {\r\n    DOMHelpers.removeAllChildren(this.container);\r\n\r\n    const incrementSize = this.config.get('incrementValueSize');\r\n\r\n    if (incrementSize && this.tags.length > incrementSize) {\r\n      const visibleTags = this.tags.slice(0, incrementSize);\r\n      visibleTags.forEach((tag) => {\r\n        this.container.appendChild(tag.getElement());\r\n      });\r\n\r\n      const remainingCount = this.tags.length - incrementSize;\r\n      this.renderCounter(remainingCount);\r\n    } else {\r\n      this.tags.forEach((tag) => {\r\n        this.container.appendChild(tag.getElement());\r\n      });\r\n    }\r\n  }\r\n\r\n  private renderCounter(count: number): void {\r\n    if (this.counterElement) {\r\n      this.counterElement.remove();\r\n    }\r\n\r\n    this.counterElement = DOMHelpers.createElement('span', 'comboselect-tag-counter');\r\n    this.counterElement.textContent = `+${count}`;\r\n    this.counterElement.title = `${count} élément(s) supplémentaire(s)`;\r\n    this.container.appendChild(this.counterElement);\r\n  }\r\n\r\n  canAddMore(): boolean {\r\n    const maxItems = this.config.get('maxItems');\r\n    return !maxItems || this.tags.length < maxItems;\r\n  }\r\n\r\n  destroy(): void {\r\n    this.tags.forEach((tag) => tag.destroy());\r\n    this.tags = [];\r\n    DOMHelpers.removeAllChildren(this.container);\r\n  }\r\n}","import type { ComboSelectConfig, SelectedItem, SuggestionItem } from '../types/index';\r\nimport { Config } from './Config';\r\nimport { EventEmitter } from './EventEmitter';\r\nimport { DataService } from '@services/DataService';\r\nimport { SearchService } from '@services/SearchService';\r\nimport { RenderService } from '@services/RenderService';\r\nimport { Input } from '@components/Input';\r\nimport { Dropdown } from '@components/Dropdown';\r\nimport { TagList } from '@components/TagList';\r\nimport { DOMHelpers } from '@utils/DOMHelpers';\r\n\r\nexport class ComboSelect {\r\n  private originalInput: HTMLInputElement;\r\n  public config: Config;\r\n  private events: EventEmitter;\r\n  private container: HTMLElement;\r\n  private controlElement: HTMLElement;\r\n  private tagsContainer: HTMLElement;\r\n  private hiddenInput: HTMLInputElement;\r\n  private rootElement: Document | ShadowRoot;\r\n  private clickHandler?: (e: Event) => void; // ← AJOUT\r\n  \r\n  // Services\r\n  private dataService: DataService<any>;\r\n  private searchService: SearchService<any>;\r\n  private renderService: RenderService;\r\n  \r\n  // Components\r\n  private input: Input;\r\n  private dropdown: Dropdown;\r\n  public tagList: TagList;\r\n  \r\n  // State\r\n  private isDisabled: boolean;\r\n\r\n  constructor(selector: string | HTMLInputElement, options: Partial<ComboSelectConfig> = {}) {\r\n    let element: HTMLInputElement;\r\n    \r\n    if (typeof selector === 'string') {\r\n      const el = document.querySelector(selector);\r\n      if (!el || !(el instanceof HTMLInputElement)) {\r\n        throw new Error(`Element \"${selector}\" not found or is not an input element`);\r\n      }\r\n      element = el;\r\n    } else if (selector instanceof HTMLInputElement) {\r\n      element = selector;\r\n    } else {\r\n      throw new Error('Selector must be a string or an HTMLInputElement');\r\n    }\r\n\r\n    this.originalInput = element;\r\n    this.rootElement = element.getRootNode() as Document | ShadowRoot;\r\n    \r\n    this.config = new Config(options);\r\n    this.events = new EventEmitter();\r\n    this.isDisabled = false;\r\n\r\n    const fullConfig = this.config.getAll();\r\n    this.dataService = new DataService<any>(fullConfig as any);\r\n    this.searchService = new SearchService<any>(fullConfig as any, this.dataService);\r\n    this.renderService = new RenderService(this.config);\r\n\r\n    this.container = this.createContainer();\r\n    this.controlElement = this.createControl();\r\n    this.tagsContainer = this.createTagsContainer();\r\n    this.hiddenInput = this.createHiddenInput();\r\n\r\n    this.input = new Input(this.config, this.events);\r\n    this.dropdown = new Dropdown(this.events, this.renderService);\r\n    this.tagList = new TagList(this.tagsContainer, this.config, this.events, this.renderService);\r\n\r\n    this.assemble();\r\n    this.attachEvents();\r\n    this.setupSearchCallbacks();\r\n    this.loadCustomCSS();\r\n\r\n    this.originalInput.style.display = 'none';\r\n  }\r\n\r\n  private createContainer(): HTMLElement {\r\n    const container = DOMHelpers.createElement('div', 'comboselect-wrapper');\r\n    return container;\r\n  }\r\n\r\n  private createControl(): HTMLElement {\r\n    const control = DOMHelpers.createElement('div', 'comboselect-control');\r\n    \r\n    control.addEventListener('click', () => {\r\n      if (!this.isDisabled) {\r\n        this.input.focus();\r\n      }\r\n    });\r\n\r\n    return control;\r\n  }\r\n\r\n  private createTagsContainer(): HTMLElement {\r\n    return DOMHelpers.createElement('div', 'comboselect-tags');\r\n  }\r\n\r\n  private createHiddenInput(): HTMLInputElement {\r\n    const input = DOMHelpers.createElement('input', '', {\r\n      type: 'hidden',\r\n      name: this.originalInput.name || '',\r\n    }) as HTMLInputElement;\r\n    return input;\r\n  }\r\n\r\n  private assemble(): void {\r\n    this.originalInput.parentNode?.insertBefore(this.container, this.originalInput.nextSibling);\r\n\r\n    this.controlElement.appendChild(this.tagsContainer);\r\n    this.controlElement.appendChild(this.input.getElement());\r\n    \r\n    this.container.appendChild(this.controlElement);\r\n    this.container.appendChild(this.dropdown.getElement());\r\n    this.container.appendChild(this.hiddenInput);\r\n  }\r\n\r\n  private setupSearchCallbacks(): void {\r\n    this.searchService.setOnResults((suggestions: SuggestionItem<any>[]) => {\r\n      const selected = this.tagList.getItems();\r\n      const selectedValues = new Set(selected.map(item => JSON.stringify(item.value)));\r\n      \r\n      const filteredSuggestions = suggestions.map(suggestion => ({\r\n        ...suggestion,\r\n        disabled: selectedValues.has(JSON.stringify(suggestion.value))\r\n      }));\r\n\r\n      this.dropdown.render(filteredSuggestions);\r\n    });\r\n\r\n    this.searchService.setOnError((error: Error) => {\r\n      console.error('Search error:', error);\r\n      this.dropdown.render([]);\r\n    });\r\n\r\n    this.searchService.setOnSearchStart(() => {\r\n    \r\n      this.dropdown.renderLoading();\r\n    });\r\n\r\n  }\r\n\r\n  private attachEvents(): void {\r\n    // Événement de recherche\r\n    this.events.on('search', async (query: string) => {\r\n      this.searchService.search(query);\r\n    });\r\n\r\n    // Événement de sélection\r\n    this.events.on('select', async (item: SelectedItem) => {\r\n      await this.handleSelect(item);\r\n    });\r\n\r\n    // Événement de suppression\r\n    this.events.on('remove', async (item: SelectedItem) => {\r\n      this.tagList.remove(item);\r\n      this.updateHiddenInput();\r\n      this.input.focus();\r\n      \r\n      const onRemove = this.config.get('onRemove');\r\n      if (onRemove) {\r\n        await onRemove(item);\r\n      }\r\n\r\n      const onChange = this.config.get('onChange');\r\n      if (onChange) {\r\n        await onChange(this.getValue());\r\n      }\r\n    });\r\n\r\n    // Événements d'ouverture/fermeture\r\n    this.events.on('open', async () => {\r\n      this.input.setAriaExpanded(true);\r\n      \r\n      const callback = this.config.get('onOpen');\r\n      if (callback) {\r\n        await callback();\r\n      }\r\n    });\r\n\r\n    this.events.on('close', async () => {\r\n      this.dropdown.close();\r\n      this.input.setAriaExpanded(false);\r\n      \r\n      const callback = this.config.get('onClose');\r\n      if (callback) {\r\n        await callback();\r\n      }\r\n    });\r\n\r\n    // ========================================\r\n    // FERMER AU CLIC EXTÉRIEUR - VERSION ROBUSTE\r\n    // ========================================\r\n    this.clickHandler = (e: Event) => {\r\n      const mouseEvent = e as MouseEvent;\r\n      \r\n      // Utiliser composedPath pour gérer le Shadow DOM\r\n      const path = mouseEvent.composedPath ? mouseEvent.composedPath() : [];\r\n      \r\n      // Vérifier si le clic est dans notre composant\r\n      let isInside = false;\r\n      \r\n      // Méthode 1: Vérifier dans le composedPath\r\n      for (const element of path) {\r\n        if (element === this.container) {\r\n          isInside = true;\r\n          break;\r\n        }\r\n      }\r\n      \r\n      // Méthode 2: Fallback avec contains (pour les navigateurs plus anciens)\r\n      if (!isInside && mouseEvent.target) {\r\n        isInside = this.container.contains(mouseEvent.target as Node);\r\n      }\r\n      \r\n      // Si le clic est en dehors ET que le dropdown est ouvert, le fermer\r\n      if (!isInside && this.dropdown.isDropdownOpen()) {\r\n        this.dropdown.close();\r\n      }\r\n    };\r\n\r\n    // Attacher au document en phase de capture pour intercepter tous les clics\r\n    // true = capture phase (important pour Shadow DOM)\r\n    document.addEventListener('click', this.clickHandler as EventListener, true);\r\n\r\n    // ========================================\r\n    // BONUS: Fermer au blur avec délai\r\n    // ========================================\r\n    this.input.getElement().addEventListener('blur', () => {\r\n      // Petit délai pour permettre aux clics sur les options de fonctionner\r\n      setTimeout(() => {\r\n        // Vérifier si le focus n'est pas dans le composant\r\n        const activeElement = document.activeElement;\r\n        const shadowActiveElement = this.rootElement instanceof ShadowRoot \r\n          ? this.rootElement.activeElement \r\n          : null;\r\n        \r\n        const hasFocus = this.container.contains(activeElement as Node) ||\r\n                        (shadowActiveElement && this.container.contains(shadowActiveElement as Node));\r\n        \r\n        if (!hasFocus && this.dropdown.isDropdownOpen()) {\r\n          this.dropdown.close();\r\n        }\r\n      }, 200);\r\n    });\r\n  }\r\n\r\n  private async handleSelect(item: SelectedItem): Promise<void> {\r\n    const multiple = this.config.get('multiple');\r\n\r\n    if (!multiple) {\r\n      this.tagList.clear();\r\n    }\r\n\r\n    if (!this.tagList.canAddMore()) {\r\n      console.warn('Maximum number of items reached');\r\n      return;\r\n    }\r\n\r\n    if (this.tagList.hasItem(item)) {\r\n      console.log('Item already selected, skipping:', item);\r\n      return;\r\n    }\r\n\r\n    const added = this.tagList.add(item);\r\n    \r\n    if (added) {\r\n      this.updateHiddenInput();\r\n\r\n      if (this.config.get('clearOnSelect')) {\r\n        this.input.clear();\r\n      }\r\n\r\n      if (this.config.get('closeOnSelect')) {\r\n        this.dropdown.close();\r\n      }\r\n\r\n      this.input.focus();\r\n\r\n      const onChange = this.config.get('onChange');\r\n      if (onChange) {\r\n        await onChange(this.getValue());\r\n      }\r\n\r\n      const onSelect = this.config.get('onSelect');\r\n      if (onSelect) {\r\n        await onSelect(item);\r\n      }\r\n    }\r\n  }\r\n\r\n  private updateHiddenInput(): void {\r\n    const items = this.tagList.getItems();\r\n    const values = items.map((item) => item.value);\r\n    this.hiddenInput.value = JSON.stringify(values);\r\n    this.originalInput.value = this.hiddenInput.value;\r\n  }\r\n\r\n  private loadCustomCSS(): void {\r\n    const cssUrl = this.config.get('cssUrl');\r\n    if (cssUrl) {\r\n      const link = document.createElement('link');\r\n      link.rel = 'stylesheet';\r\n      link.href = cssUrl;\r\n      \r\n      if (this.rootElement instanceof ShadowRoot) {\r\n        this.rootElement.appendChild(link);\r\n      } else {\r\n        document.head.appendChild(link);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Public API\r\n\r\n  public getValue(): SelectedItem[] {\r\n    return this.tagList.getItems();\r\n  }\r\n\r\n  public setValue(items: SelectedItem[]): void {\r\n    this.tagList.clear();\r\n    items.forEach((item) => {\r\n      if (this.tagList.canAddMore()) {\r\n        this.tagList.add(item);\r\n      }\r\n    });\r\n    this.updateHiddenInput();\r\n  }\r\n\r\n  public clear(): void {\r\n    this.tagList.clear();\r\n    this.input.clear();\r\n    this.dropdown.close();\r\n    this.updateHiddenInput();\r\n    this.searchService.reset();\r\n  }\r\n\r\n  public disable(): void {\r\n    this.isDisabled = true;\r\n    this.input.disable();\r\n    this.controlElement.classList.add('disabled');\r\n    this.dropdown.close();\r\n  }\r\n\r\n  public enable(): void {\r\n    this.isDisabled = false;\r\n    this.input.enable();\r\n    this.controlElement.classList.remove('disabled');\r\n  }\r\n\r\n  public destroy(): void {\r\n    // ========================================\r\n    // IMPORTANT: Retirer le click handler\r\n    // ========================================\r\n    if (this.clickHandler) {\r\n      document.removeEventListener('click', this.clickHandler as EventListener, true);\r\n    }\r\n    \r\n    this.searchService.abort();\r\n    this.events.clear();\r\n    this.input.destroy();\r\n    this.dropdown.destroy();\r\n    this.tagList.destroy();\r\n    this.container.remove();\r\n    this.originalInput.style.display = '';\r\n  }\r\n\r\n  public open(): void {\r\n    if (!this.isDisabled) {\r\n      const query = this.input.getValue();\r\n      if (query) {\r\n        this.searchService.searchImmediate(query);\r\n      }\r\n    }\r\n  }\r\n\r\n  public close(): void {\r\n    this.dropdown.close();\r\n  }\r\n\r\n  public addItem(item: SelectedItem): void {\r\n    if (this.tagList.canAddMore()) {\r\n      this.tagList.add(item);\r\n      this.updateHiddenInput();\r\n    }\r\n  }\r\n\r\n  public removeItem(item: SelectedItem): void {\r\n    this.tagList.remove(item);\r\n    this.updateHiddenInput();\r\n  }\r\n\r\n  public clearCache(): void {\r\n    this.dataService.clearCache();\r\n  }\r\n}","import { ComboSelect } from '@core/ComboSelect';\r\nimport type { ComboSelectConfig, SelectedItem } from '../types/index';\r\nimport styles from '../styles/comboselect.css?inline';\r\n\r\nexport class ComboSelectElement extends HTMLElement {\r\n  private comboSelect?: ComboSelect;\r\n  private inputElement?: HTMLInputElement;\r\n  private _dataSource?: any[] | (() => any[] | Promise<any[]>);\r\n\r\n  constructor() {\r\n    super();\r\n    this.attachShadow({ mode: 'open' });\r\n  }\r\n\r\n  static get observedAttributes() {\r\n    return [\r\n      'placeholder',\r\n      'multiple',\r\n      'max-items',\r\n      'min-chars',\r\n      'debounce-delay',\r\n      'label-suggestion',\r\n      'value-suggestion',\r\n      'increment-value-size',\r\n      'disabled',\r\n      'autocomplete-url',\r\n      'results-key',\r\n      'close-on-select',\r\n    ];\r\n  }\r\n\r\n  connectedCallback() {\r\n    this.render();\r\n    this.initComboSelect();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.comboSelect?.destroy();\r\n  }\r\n\r\n  attributeChangedCallback(_name: string, oldValue: string, newValue: string) {\r\n    if (oldValue !== newValue && this.comboSelect) {\r\n      this.updateConfig();\r\n    }\r\n  }\r\n\r\n  private render() {\r\n    if (!this.shadowRoot) return;\r\n\r\n    // Créer le style\r\n    const styleEl = document.createElement('style');\r\n    styleEl.textContent = styles;\r\n\r\n    // Créer l'input\r\n    this.inputElement = document.createElement('input');\r\n    this.inputElement.type = 'text';\r\n    this.inputElement.className = 'comboselect-internal-input';\r\n    this.inputElement.id = 'combo-input';\r\n\r\n    // Ajouter au Shadow DOM\r\n    this.shadowRoot.appendChild(styleEl);\r\n    this.shadowRoot.appendChild(this.inputElement);\r\n  }\r\n\r\n  private initComboSelect() {\r\n    if (!this.inputElement || !this.shadowRoot) return;\r\n\r\n    const config = this.buildConfig();\r\n    const inputEl = this.shadowRoot.querySelector('#combo-input') as HTMLInputElement;\r\n\r\n    if (!inputEl) return;\r\n\r\n    // Passer directement l'élément HTMLInputElement\r\n    this.comboSelect = new ComboSelect(inputEl, config);\r\n\r\n    console.log('✅ ComboSelect initialized with config:', config);\r\n  }\r\n\r\n  private buildConfig(): Partial<ComboSelectConfig> {\r\n    const config: Partial<ComboSelectConfig> = {\r\n      placeholder: this.getAttribute('placeholder') || 'Sélectionner...',\r\n      multiple: this.hasAttribute('multiple'),\r\n      labelSuggestion: this.getAttribute('label-suggestion') || 'label',\r\n      valueSuggestion: this.getAttribute('value-suggestion') || null,\r\n    };\r\n\r\n    // Max items\r\n    const maxItems = this.getAttribute('max-items');\r\n    if (maxItems) config.maxItems = parseInt(maxItems, 10);\r\n\r\n    // Min chars\r\n    const minChars = this.getAttribute('min-chars');\r\n    if (minChars) config.minChars = parseInt(minChars, 10);\r\n\r\n    // Debounce delay\r\n    const debounceDelay = this.getAttribute('debounce-delay');\r\n    if (debounceDelay) config.debounceDelay = parseInt(debounceDelay, 10);\r\n\r\n    // Increment value size\r\n    const incrementValueSize = this.getAttribute('increment-value-size');\r\n    if (incrementValueSize) config.incrementValueSize = parseInt(incrementValueSize, 10);\r\n\r\n    // Data source depuis la propriété JavaScript\r\n    if (this._dataSource) {\r\n      config.dataSource = this._dataSource;\r\n      console.log('📦 DataSource set:', this._dataSource);\r\n    }\r\n\r\n    // Autocomplete URL\r\n    const autocompleteUrl = this.getAttribute('autocomplete-url');\r\n    if (autocompleteUrl) {\r\n      config.autocompleteUrl = autocompleteUrl;\r\n      console.log('🌐 Autocomplete URL:', autocompleteUrl);\r\n    }\r\n\r\n    // Results key\r\n    const resultsKey = this.getAttribute('results-key');\r\n    if (resultsKey) {\r\n      config.resultsKey = resultsKey;\r\n    }\r\n\r\n    // Close on select\r\n    const closeOnSelect = this.getAttribute('close-on-select');\r\n    if (closeOnSelect !== null) {\r\n      config.closeOnSelect = closeOnSelect === 'true';\r\n    }\r\n\r\n    // Ajouter les callbacks pour émettre des événements\r\n    config.onSelect = (item: SelectedItem) => {\r\n      this.dispatchEvent(new CustomEvent('comboselect-select', { \r\n        detail: item,\r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n    };\r\n\r\n    config.onChange = (items: SelectedItem[]) => {\r\n      this.dispatchEvent(new CustomEvent('comboselect-change', { \r\n        detail: items,\r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n      this.dispatchEvent(new CustomEvent('change', { \r\n        detail: items,\r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n    };\r\n\r\n    config.onRemove = (item: SelectedItem) => {\r\n      this.dispatchEvent(new CustomEvent('comboselect-remove', { \r\n        detail: item,\r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n    };\r\n\r\n    config.onOpen = () => {\r\n      this.dispatchEvent(new CustomEvent('comboselect-open', { \r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n    };\r\n\r\n    config.onClose = () => {\r\n      this.dispatchEvent(new CustomEvent('comboselect-close', { \r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n    };\r\n\r\n    config.onSearch = (query: string) => {\r\n      this.dispatchEvent(new CustomEvent('comboselect-search', { \r\n        detail: { query },\r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n    };\r\n\r\n    config.onLoad = (data: any[]) => {\r\n      this.dispatchEvent(new CustomEvent('comboselect-load', { \r\n        detail: data,\r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n    };\r\n\r\n    config.onError = (error: Error) => {\r\n      console.error('❌ ComboSelect error:', error);\r\n      this.dispatchEvent(new CustomEvent('comboselect-error', { \r\n        detail: error,\r\n        bubbles: true,\r\n        composed: true \r\n      }));\r\n    };\r\n\r\n    return config;\r\n  }\r\n\r\n  private updateConfig() {\r\n    // Reconstruire et mettre à jour la config\r\n    if (this.comboSelect) {\r\n      this.comboSelect.destroy();\r\n      this.initComboSelect();\r\n    }\r\n  }\r\n\r\n  // API publique\r\n  get dataSource(): any[] | (() => any[] | Promise<any[]>) | undefined {\r\n    return this._dataSource;\r\n  }\r\n\r\n  set dataSource(value: any[] | (() => any[] | Promise<any[]>) | undefined) {\r\n    console.log('🔧 Setting dataSource:', value);\r\n    this._dataSource = value;\r\n    \r\n    // Si ComboSelect est déjà initialisé, le recréer avec les nouvelles données\r\n    if (this.comboSelect) {\r\n      console.log('♻️ Recreating ComboSelect with new dataSource');\r\n      this.updateConfig();\r\n    }\r\n  }\r\n\r\n  getValue(): SelectedItem[] {\r\n    return this.comboSelect?.getValue() || [];\r\n  }\r\n\r\n  setValue(items: SelectedItem[]): void {\r\n    this.comboSelect?.setValue(items);\r\n  }\r\n\r\n  clear(): void {\r\n    this.comboSelect?.clear();\r\n  }\r\n\r\n  open(): void {\r\n    this.comboSelect?.open();\r\n  }\r\n\r\n  close(): void {\r\n    this.comboSelect?.close();\r\n  }\r\n\r\n  get disabled(): boolean {\r\n    return this.hasAttribute('disabled');\r\n  }\r\n\r\n  set disabled(value: boolean) {\r\n    if (value) {\r\n      this.setAttribute('disabled', '');\r\n      this.comboSelect?.disable();\r\n    } else {\r\n      this.removeAttribute('disabled');\r\n      this.comboSelect?.enable();\r\n    }\r\n  }\r\n}\r\n\r\n// Définir le custom element\r\nif (!customElements.get('combo-select')) {\r\n  customElements.define('combo-select', ComboSelectElement);\r\n}"],"names":["Validators","config","url","_Config","userConfig","__publicField","key","updates","Config","EventEmitter","event","callback","callbacks","args","error","DEFAULTS","CSS_CLASSES","EVENTS","KEYBOARD_KEYS","ARIA_ATTRIBUTES","ERROR_MESSAGES","DEFAULT_HTTP_HEADERS","TIMEOUTS","DataService","query","dataSource","result","autocompleteUrl","searchParam","httpMethod","httpHeaders","cacheKey","fetchOptions","method","param","separator","timeoutId","response","data","results","resultsKey","transformResponse","keys","searchTerm","labelSuggestion","labelKey","item","value","SearchService","dataService","minChars","debounceDelay","filteredData","suggestions","errorObj","callbackError","valueSuggestion","valueKey","label","DOMHelpers","tag","className","attributes","element","text","div","rect","parent","child","node","RenderService","customRender","debounce","func","wait","timeout","later","Input","events","expanded","Dropdown","renderService","direction","suggestion","index","option","e","maxIndex","newIndex","Tag","renderContent","content","removeBtn","TagList","container","existingTagIndex","existingValue","newValue","incrementSize","remainingCount","count","maxItems","ComboSelect","selector","options","el","fullConfig","control","selected","selectedValues","filteredSuggestions","onRemove","onChange","mouseEvent","path","isInside","activeElement","shadowActiveElement","onSelect","values","cssUrl","link","items","ComboSelectElement","_name","oldValue","styleEl","styles","inputEl","incrementValueSize","closeOnSelect"],"mappings":"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"}